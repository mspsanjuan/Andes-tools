<plex-layout>
    <plex-layout-main>
        <header>
            <div class="row">
                <div class="col-4">
                    <plex-select [(ngModel)]="organizacion" name="organizacion"
                        [data]="opcionesOrganizacion" label="Organización"
                        placeholder="Seleccione la organización"
                        labelField="nombre" [required]="true">
                    </plex-select>
                </div>
                <br />
                <div class="col-2">
                    <!-- Select Mes -->
                    <plex-select [(ngModel)]="mes" name="mes" [data]="opcionesMes" label="Mes"
                        placeholder="Mes" [required]="true">
                    </plex-select>
                </div>
    
                <div class="col-2">
                    <!-- Select Año -->
                    <plex-select [(ngModel)]="anio" name="año" [data]="opcionesAnio" label="Año"
                        placeholder="Año" [required]="true">
                    </plex-select>
                </div>
            </div>
        </header>
        <div *ngIf="reporte && reporte.length" class="row">
            <div class="col">
                <plex-box type="primary">
                    <table class="table table-striped table-bordered">
                        <thead style="background-color: darkgray;">
                            <tr>
                                <th>CodProv</th>
                                <th>CodEst</th>
                                <th>AnioConsul</th>
                                <th>MesConsul</th>
                                <th>CodUOperat</th>
                                <th>NumOrden</th>
                                <th>RangoEdad</th>
                                <th>Varones</th>
                                <th>Mujeres</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let linea of reporte; let i=index" class="hover" [ngStyle]="{'font-weight': 'bold'}">
                                <th>{{linea.CodProv}}</th>
                                <th>{{linea.CodEst}}</th>
                                <th>{{linea.AnioConsul}}</th>
                                <th>{{linea.MesConsul}}</th>
                                <th>{{linea.CodUOperat}}</th>
                                <th>{{linea.NumOrden}}</th>
                                <th>{{linea.RangoEdad}}</th>
                                <th>{{linea.Varones}}</th>
                                <th>{{linea.Mujeres}}</th>
                            </tr>
                        </tbody>
                    </table>
                </plex-box>
            </div>
        </div>
    </plex-layout-main>

    <plex-layout-footer>
        <plex-button position="left" type="danger" label="Volver" (click)="volver()"></plex-button>
        <plex-button position="right" type="success" label="Generar Reporte" (click)="generar()"></plex-button>
        <plex-button *ngIf="reporte && reporte.length" type="success" position="right" label="Exportar a EXCEL"
        (click)="exportToExcel()"></plex-button>
    </plex-layout-footer>
</plex-layout>